/**
 * Songs API - Supabase REST API functions
 *
 * Pure functions for data fetching and mutations.
 * No React hooks, no side effects beyond Supabase calls.
 *
 * TODO: Implement these functions when integrating with database
 */

import { createClient } from "@/lib/supabase/client"
import type { Database } from "@/lib/supabase/database.types"
import type { AppContext } from "@/features/app-context"

// Use built-in type shorthands (auto-generated by Supabase CLI)
type Song = Database["public"]["Tables"]["songs"]["Row"]
type SongInsert = Database["public"]["Tables"]["songs"]["Insert"]
type SongUpdate = Database["public"]["Tables"]["songs"]["Update"]

/**
 * Fetch songs based on context (personal or team)
 *
 * @param context - App context (personal or team)
 * @returns Promise<Song[]> - Array of songs
 */
export async function getSongs(context: AppContext): Promise<Song[]> {
  // TODO: Implement when AppContext is available
  // const supabase = createClient()
  //
  // let query = supabase.from("songs").select("*")
  //
  // if (context.type === "personal") {
  //   query = query.eq("user_id", context.userId)
  // } else {
  //   query = query.eq("team_id", context.teamId)
  // }
  //
  // const { data, error } = await query.order("created_at", { ascending: false })
  //
  // if (error) throw error
  // return data || []

  throw new Error("Not implemented: getSongs")
}

/**
 * Get a single song by ID
 *
 * @param songId - Song UUID
 * @returns Promise<Song | null> - Song or null if not found
 */
export async function getSong(songId: string): Promise<Song | null> {
  // TODO: Implement
  // const supabase = createClient()
  //
  // const { data, error } = await supabase
  //   .from("songs")
  //   .select("*")
  //   .eq("id", songId)
  //   .single()
  //
  // if (error) {
  //   if (error.code === "PGRST116") return null
  //   throw error
  // }
  //
  // return data

  throw new Error("Not implemented: getSong")
}

/**
 * Create a new song
 *
 * @param song - Song data to insert
 * @returns Promise<Song> - Created song
 */
export async function createSong(song: SongInsert): Promise<Song> {
  // TODO: Implement
  // const supabase = createClient()
  //
  // const { data, error } = await supabase
  //   .from("songs")
  //   .insert(song)
  //   .select()
  //   .single()
  //
  // if (error) throw error
  // return data

  throw new Error("Not implemented: createSong")
}

/**
 * Update a song
 *
 * @param songId - Song UUID
 * @param updates - Partial song data to update
 * @returns Promise<Song> - Updated song
 */
export async function updateSong(songId: string, updates: SongUpdate): Promise<Song> {
  // TODO: Implement
  // const supabase = createClient()
  //
  // const { data, error } = await supabase
  //   .from("songs")
  //   .update(updates)
  //   .eq("id", songId)
  //   .select()
  //   .single()
  //
  // if (error) throw error
  // return data

  throw new Error("Not implemented: updateSong")
}

/**
 * Delete a song
 *
 * @param songId - Song UUID
 * @returns Promise<void>
 */
export async function deleteSong(songId: string): Promise<void> {
  // TODO: Implement
  // const supabase = createClient()
  //
  // const { error } = await supabase
  //   .from("songs")
  //   .delete()
  //   .eq("id", songId)
  //
  // if (error) throw error

  throw new Error("Not implemented: deleteSong")
}
